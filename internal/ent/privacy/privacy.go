// Code generated by entc, DO NOT EDIT.

package privacy

import (
	"context"
	"fmt"

	"github.com/auroraride/aurservd/internal/ent"

	"entgo.io/ent/entql"
	"entgo.io/ent/privacy"
)

var (
	// Allow may be returned by rules to indicate that the policy
	// evaluation should terminate with an allow decision.
	Allow = privacy.Allow

	// Deny may be returned by rules to indicate that the policy
	// evaluation should terminate with an deny decision.
	Deny = privacy.Deny

	// Skip may be returned by rules to indicate that the policy
	// evaluation should continue to the next rule.
	Skip = privacy.Skip
)

// Allowf returns an formatted wrapped Allow decision.
func Allowf(format string, a ...interface{}) error {
	return fmt.Errorf(format+": %w", append(a, Allow)...)
}

// Denyf returns an formatted wrapped Deny decision.
func Denyf(format string, a ...interface{}) error {
	return fmt.Errorf(format+": %w", append(a, Deny)...)
}

// Skipf returns an formatted wrapped Skip decision.
func Skipf(format string, a ...interface{}) error {
	return fmt.Errorf(format+": %w", append(a, Skip)...)
}

// DecisionContext creates a new context from the given parent context with
// a policy decision attach to it.
func DecisionContext(parent context.Context, decision error) context.Context {
	return privacy.DecisionContext(parent, decision)
}

// DecisionFromContext retrieves the policy decision from the context.
func DecisionFromContext(ctx context.Context) (error, bool) {
	return privacy.DecisionFromContext(ctx)
}

type (
	// QueryRule defines the interface deciding whether a
	// query is allowed and optionally modify it.
	QueryRule = privacy.QueryRule
	// QueryPolicy combines multiple query rules into a single policy.
	QueryPolicy = privacy.QueryPolicy
)

// QueryRuleFunc type is an adapter to allow the use of
// ordinary functions as query rules.
type QueryRuleFunc func(context.Context, ent.Query) error

// Eval returns f(ctx, q).
func (f QueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	return f(ctx, q)
}

type (
	// MutationRule defines the interface which decides whether a
	// mutation is allowed and optionally modifies it.
	MutationRule = privacy.MutationRule
	// MutationPolicy combines multiple mutation rules into a single policy.
	MutationPolicy = privacy.MutationPolicy
)

// MutationRuleFunc type is an adapter which allows the use of
// ordinary functions as mutation rules.
type MutationRuleFunc func(context.Context, ent.Mutation) error

// EvalMutation returns f(ctx, m).
func (f MutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	return f(ctx, m)
}

// Policy groups query and mutation policies.
type Policy struct {
	Query    QueryPolicy
	Mutation MutationPolicy
}

// EvalQuery forwards evaluation to query a policy.
func (policy Policy) EvalQuery(ctx context.Context, q ent.Query) error {
	return policy.Query.EvalQuery(ctx, q)
}

// EvalMutation forwards evaluation to mutate a  policy.
func (policy Policy) EvalMutation(ctx context.Context, m ent.Mutation) error {
	return policy.Mutation.EvalMutation(ctx, m)
}

// QueryMutationRule is an interface which groups query and mutation rules.
type QueryMutationRule interface {
	QueryRule
	MutationRule
}

// AlwaysAllowRule returns a rule that returns an allow decision.
func AlwaysAllowRule() QueryMutationRule {
	return fixedDecision{Allow}
}

// AlwaysDenyRule returns a rule that returns a deny decision.
func AlwaysDenyRule() QueryMutationRule {
	return fixedDecision{Deny}
}

type fixedDecision struct {
	decision error
}

func (f fixedDecision) EvalQuery(context.Context, ent.Query) error {
	return f.decision
}

func (f fixedDecision) EvalMutation(context.Context, ent.Mutation) error {
	return f.decision
}

type contextDecision struct {
	eval func(context.Context) error
}

// ContextQueryMutationRule creates a query/mutation rule from a context eval func.
func ContextQueryMutationRule(eval func(context.Context) error) QueryMutationRule {
	return contextDecision{eval}
}

func (c contextDecision) EvalQuery(ctx context.Context, _ ent.Query) error {
	return c.eval(ctx)
}

func (c contextDecision) EvalMutation(ctx context.Context, _ ent.Mutation) error {
	return c.eval(ctx)
}

// OnMutationOperation evaluates the given rule only on a given mutation operation.
func OnMutationOperation(rule MutationRule, op ent.Op) MutationRule {
	return MutationRuleFunc(func(ctx context.Context, m ent.Mutation) error {
		if m.Op().Is(op) {
			return rule.EvalMutation(ctx, m)
		}
		return Skip
	})
}

// DenyMutationOperationRule returns a rule denying specified mutation operation.
func DenyMutationOperationRule(op ent.Op) MutationRule {
	rule := MutationRuleFunc(func(_ context.Context, m ent.Mutation) error {
		return Denyf("ent/privacy: operation %s is not allowed", m.Op())
	})
	return OnMutationOperation(rule, op)
}

// The BatteryModelQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type BatteryModelQueryRuleFunc func(context.Context, *ent.BatteryModelQuery) error

// EvalQuery return f(ctx, q).
func (f BatteryModelQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.BatteryModelQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.BatteryModelQuery", q)
}

// The BatteryModelMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type BatteryModelMutationRuleFunc func(context.Context, *ent.BatteryModelMutation) error

// EvalMutation calls f(ctx, m).
func (f BatteryModelMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.BatteryModelMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.BatteryModelMutation", m)
}

// The BranchQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type BranchQueryRuleFunc func(context.Context, *ent.BranchQuery) error

// EvalQuery return f(ctx, q).
func (f BranchQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.BranchQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.BranchQuery", q)
}

// The BranchMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type BranchMutationRuleFunc func(context.Context, *ent.BranchMutation) error

// EvalMutation calls f(ctx, m).
func (f BranchMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.BranchMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.BranchMutation", m)
}

// The BranchContractQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type BranchContractQueryRuleFunc func(context.Context, *ent.BranchContractQuery) error

// EvalQuery return f(ctx, q).
func (f BranchContractQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.BranchContractQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.BranchContractQuery", q)
}

// The BranchContractMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type BranchContractMutationRuleFunc func(context.Context, *ent.BranchContractMutation) error

// EvalMutation calls f(ctx, m).
func (f BranchContractMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.BranchContractMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.BranchContractMutation", m)
}

// The CabinetQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type CabinetQueryRuleFunc func(context.Context, *ent.CabinetQuery) error

// EvalQuery return f(ctx, q).
func (f CabinetQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.CabinetQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.CabinetQuery", q)
}

// The CabinetMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type CabinetMutationRuleFunc func(context.Context, *ent.CabinetMutation) error

// EvalMutation calls f(ctx, m).
func (f CabinetMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.CabinetMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.CabinetMutation", m)
}

// The CabinetExchangeQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type CabinetExchangeQueryRuleFunc func(context.Context, *ent.CabinetExchangeQuery) error

// EvalQuery return f(ctx, q).
func (f CabinetExchangeQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.CabinetExchangeQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.CabinetExchangeQuery", q)
}

// The CabinetExchangeMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type CabinetExchangeMutationRuleFunc func(context.Context, *ent.CabinetExchangeMutation) error

// EvalMutation calls f(ctx, m).
func (f CabinetExchangeMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.CabinetExchangeMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.CabinetExchangeMutation", m)
}

// The CabinetFaultQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type CabinetFaultQueryRuleFunc func(context.Context, *ent.CabinetFaultQuery) error

// EvalQuery return f(ctx, q).
func (f CabinetFaultQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.CabinetFaultQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.CabinetFaultQuery", q)
}

// The CabinetFaultMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type CabinetFaultMutationRuleFunc func(context.Context, *ent.CabinetFaultMutation) error

// EvalMutation calls f(ctx, m).
func (f CabinetFaultMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.CabinetFaultMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.CabinetFaultMutation", m)
}

// The CityQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type CityQueryRuleFunc func(context.Context, *ent.CityQuery) error

// EvalQuery return f(ctx, q).
func (f CityQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.CityQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.CityQuery", q)
}

// The CityMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type CityMutationRuleFunc func(context.Context, *ent.CityMutation) error

// EvalMutation calls f(ctx, m).
func (f CityMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.CityMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.CityMutation", m)
}

// The CommissionQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type CommissionQueryRuleFunc func(context.Context, *ent.CommissionQuery) error

// EvalQuery return f(ctx, q).
func (f CommissionQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.CommissionQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.CommissionQuery", q)
}

// The CommissionMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type CommissionMutationRuleFunc func(context.Context, *ent.CommissionMutation) error

// EvalMutation calls f(ctx, m).
func (f CommissionMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.CommissionMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.CommissionMutation", m)
}

// The ContractQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type ContractQueryRuleFunc func(context.Context, *ent.ContractQuery) error

// EvalQuery return f(ctx, q).
func (f ContractQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.ContractQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.ContractQuery", q)
}

// The ContractMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type ContractMutationRuleFunc func(context.Context, *ent.ContractMutation) error

// EvalMutation calls f(ctx, m).
func (f ContractMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.ContractMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.ContractMutation", m)
}

// The EmployeeQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type EmployeeQueryRuleFunc func(context.Context, *ent.EmployeeQuery) error

// EvalQuery return f(ctx, q).
func (f EmployeeQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.EmployeeQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.EmployeeQuery", q)
}

// The EmployeeMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type EmployeeMutationRuleFunc func(context.Context, *ent.EmployeeMutation) error

// EvalMutation calls f(ctx, m).
func (f EmployeeMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.EmployeeMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.EmployeeMutation", m)
}

// The EnterpriseQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type EnterpriseQueryRuleFunc func(context.Context, *ent.EnterpriseQuery) error

// EvalQuery return f(ctx, q).
func (f EnterpriseQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.EnterpriseQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.EnterpriseQuery", q)
}

// The EnterpriseMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type EnterpriseMutationRuleFunc func(context.Context, *ent.EnterpriseMutation) error

// EvalMutation calls f(ctx, m).
func (f EnterpriseMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.EnterpriseMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.EnterpriseMutation", m)
}

// The ManagerQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type ManagerQueryRuleFunc func(context.Context, *ent.ManagerQuery) error

// EvalQuery return f(ctx, q).
func (f ManagerQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.ManagerQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.ManagerQuery", q)
}

// The ManagerMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type ManagerMutationRuleFunc func(context.Context, *ent.ManagerMutation) error

// EvalMutation calls f(ctx, m).
func (f ManagerMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.ManagerMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.ManagerMutation", m)
}

// The OrderQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type OrderQueryRuleFunc func(context.Context, *ent.OrderQuery) error

// EvalQuery return f(ctx, q).
func (f OrderQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.OrderQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.OrderQuery", q)
}

// The OrderMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type OrderMutationRuleFunc func(context.Context, *ent.OrderMutation) error

// EvalMutation calls f(ctx, m).
func (f OrderMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.OrderMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.OrderMutation", m)
}

// The OrderRefundQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type OrderRefundQueryRuleFunc func(context.Context, *ent.OrderRefundQuery) error

// EvalQuery return f(ctx, q).
func (f OrderRefundQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.OrderRefundQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.OrderRefundQuery", q)
}

// The OrderRefundMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type OrderRefundMutationRuleFunc func(context.Context, *ent.OrderRefundMutation) error

// EvalMutation calls f(ctx, m).
func (f OrderRefundMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.OrderRefundMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.OrderRefundMutation", m)
}

// The PersonQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type PersonQueryRuleFunc func(context.Context, *ent.PersonQuery) error

// EvalQuery return f(ctx, q).
func (f PersonQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.PersonQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.PersonQuery", q)
}

// The PersonMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type PersonMutationRuleFunc func(context.Context, *ent.PersonMutation) error

// EvalMutation calls f(ctx, m).
func (f PersonMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.PersonMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.PersonMutation", m)
}

// The PlanQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type PlanQueryRuleFunc func(context.Context, *ent.PlanQuery) error

// EvalQuery return f(ctx, q).
func (f PlanQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.PlanQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.PlanQuery", q)
}

// The PlanMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type PlanMutationRuleFunc func(context.Context, *ent.PlanMutation) error

// EvalMutation calls f(ctx, m).
func (f PlanMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.PlanMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.PlanMutation", m)
}

// The RiderQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type RiderQueryRuleFunc func(context.Context, *ent.RiderQuery) error

// EvalQuery return f(ctx, q).
func (f RiderQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.RiderQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.RiderQuery", q)
}

// The RiderMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type RiderMutationRuleFunc func(context.Context, *ent.RiderMutation) error

// EvalMutation calls f(ctx, m).
func (f RiderMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.RiderMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.RiderMutation", m)
}

// The SettingQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type SettingQueryRuleFunc func(context.Context, *ent.SettingQuery) error

// EvalQuery return f(ctx, q).
func (f SettingQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.SettingQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.SettingQuery", q)
}

// The SettingMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type SettingMutationRuleFunc func(context.Context, *ent.SettingMutation) error

// EvalMutation calls f(ctx, m).
func (f SettingMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.SettingMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.SettingMutation", m)
}

// The StoreQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type StoreQueryRuleFunc func(context.Context, *ent.StoreQuery) error

// EvalQuery return f(ctx, q).
func (f StoreQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.StoreQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.StoreQuery", q)
}

// The StoreMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type StoreMutationRuleFunc func(context.Context, *ent.StoreMutation) error

// EvalMutation calls f(ctx, m).
func (f StoreMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.StoreMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.StoreMutation", m)
}

// The SubscribeQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type SubscribeQueryRuleFunc func(context.Context, *ent.SubscribeQuery) error

// EvalQuery return f(ctx, q).
func (f SubscribeQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.SubscribeQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.SubscribeQuery", q)
}

// The SubscribeMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type SubscribeMutationRuleFunc func(context.Context, *ent.SubscribeMutation) error

// EvalMutation calls f(ctx, m).
func (f SubscribeMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.SubscribeMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.SubscribeMutation", m)
}

// The SubscribeAlterQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type SubscribeAlterQueryRuleFunc func(context.Context, *ent.SubscribeAlterQuery) error

// EvalQuery return f(ctx, q).
func (f SubscribeAlterQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.SubscribeAlterQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.SubscribeAlterQuery", q)
}

// The SubscribeAlterMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type SubscribeAlterMutationRuleFunc func(context.Context, *ent.SubscribeAlterMutation) error

// EvalMutation calls f(ctx, m).
func (f SubscribeAlterMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.SubscribeAlterMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.SubscribeAlterMutation", m)
}

// The SubscribePauseQueryRuleFunc type is an adapter to allow the use of ordinary
// functions as a query rule.
type SubscribePauseQueryRuleFunc func(context.Context, *ent.SubscribePauseQuery) error

// EvalQuery return f(ctx, q).
func (f SubscribePauseQueryRuleFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	if q, ok := q.(*ent.SubscribePauseQuery); ok {
		return f(ctx, q)
	}
	return Denyf("ent/privacy: unexpected query type %T, expect *ent.SubscribePauseQuery", q)
}

// The SubscribePauseMutationRuleFunc type is an adapter to allow the use of ordinary
// functions as a mutation rule.
type SubscribePauseMutationRuleFunc func(context.Context, *ent.SubscribePauseMutation) error

// EvalMutation calls f(ctx, m).
func (f SubscribePauseMutationRuleFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	if m, ok := m.(*ent.SubscribePauseMutation); ok {
		return f(ctx, m)
	}
	return Denyf("ent/privacy: unexpected mutation type %T, expect *ent.SubscribePauseMutation", m)
}

type (
	// Filter is the interface that wraps the Where function
	// for filtering nodes in queries and mutations.
	Filter interface {
		// Where applies a filter on the executed query/mutation.
		Where(entql.P)
	}

	// The FilterFunc type is an adapter that allows the use of ordinary
	// functions as filters for query and mutation types.
	FilterFunc func(context.Context, Filter) error
)

// EvalQuery calls f(ctx, q) if the query implements the Filter interface, otherwise it is denied.
func (f FilterFunc) EvalQuery(ctx context.Context, q ent.Query) error {
	fr, err := queryFilter(q)
	if err != nil {
		return err
	}
	return f(ctx, fr)
}

// EvalMutation calls f(ctx, q) if the mutation implements the Filter interface, otherwise it is denied.
func (f FilterFunc) EvalMutation(ctx context.Context, m ent.Mutation) error {
	fr, err := mutationFilter(m)
	if err != nil {
		return err
	}
	return f(ctx, fr)
}

var _ QueryMutationRule = FilterFunc(nil)

func queryFilter(q ent.Query) (Filter, error) {
	switch q := q.(type) {
	case *ent.BatteryModelQuery:
		return q.Filter(), nil
	case *ent.BranchQuery:
		return q.Filter(), nil
	case *ent.BranchContractQuery:
		return q.Filter(), nil
	case *ent.CabinetQuery:
		return q.Filter(), nil
	case *ent.CabinetExchangeQuery:
		return q.Filter(), nil
	case *ent.CabinetFaultQuery:
		return q.Filter(), nil
	case *ent.CityQuery:
		return q.Filter(), nil
	case *ent.CommissionQuery:
		return q.Filter(), nil
	case *ent.ContractQuery:
		return q.Filter(), nil
	case *ent.EmployeeQuery:
		return q.Filter(), nil
	case *ent.EnterpriseQuery:
		return q.Filter(), nil
	case *ent.ManagerQuery:
		return q.Filter(), nil
	case *ent.OrderQuery:
		return q.Filter(), nil
	case *ent.OrderRefundQuery:
		return q.Filter(), nil
	case *ent.PersonQuery:
		return q.Filter(), nil
	case *ent.PlanQuery:
		return q.Filter(), nil
	case *ent.RiderQuery:
		return q.Filter(), nil
	case *ent.SettingQuery:
		return q.Filter(), nil
	case *ent.StoreQuery:
		return q.Filter(), nil
	case *ent.SubscribeQuery:
		return q.Filter(), nil
	case *ent.SubscribeAlterQuery:
		return q.Filter(), nil
	case *ent.SubscribePauseQuery:
		return q.Filter(), nil
	default:
		return nil, Denyf("ent/privacy: unexpected query type %T for query filter", q)
	}
}

func mutationFilter(m ent.Mutation) (Filter, error) {
	switch m := m.(type) {
	case *ent.BatteryModelMutation:
		return m.Filter(), nil
	case *ent.BranchMutation:
		return m.Filter(), nil
	case *ent.BranchContractMutation:
		return m.Filter(), nil
	case *ent.CabinetMutation:
		return m.Filter(), nil
	case *ent.CabinetExchangeMutation:
		return m.Filter(), nil
	case *ent.CabinetFaultMutation:
		return m.Filter(), nil
	case *ent.CityMutation:
		return m.Filter(), nil
	case *ent.CommissionMutation:
		return m.Filter(), nil
	case *ent.ContractMutation:
		return m.Filter(), nil
	case *ent.EmployeeMutation:
		return m.Filter(), nil
	case *ent.EnterpriseMutation:
		return m.Filter(), nil
	case *ent.ManagerMutation:
		return m.Filter(), nil
	case *ent.OrderMutation:
		return m.Filter(), nil
	case *ent.OrderRefundMutation:
		return m.Filter(), nil
	case *ent.PersonMutation:
		return m.Filter(), nil
	case *ent.PlanMutation:
		return m.Filter(), nil
	case *ent.RiderMutation:
		return m.Filter(), nil
	case *ent.SettingMutation:
		return m.Filter(), nil
	case *ent.StoreMutation:
		return m.Filter(), nil
	case *ent.SubscribeMutation:
		return m.Filter(), nil
	case *ent.SubscribeAlterMutation:
		return m.Filter(), nil
	case *ent.SubscribePauseMutation:
		return m.Filter(), nil
	default:
		return nil, Denyf("ent/privacy: unexpected mutation type %T for mutation filter", m)
	}
}
